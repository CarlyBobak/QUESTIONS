<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Compute sample-level spillover summary scores — summarize_spillover_per_sample • QUESTIONS</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute sample-level spillover summary scores — summarize_spillover_per_sample"><meta name="description" content="Aggregates expression data using gene-level spillover weights. Accepts either a single matrix/vector
or lists of both for timecourse-style analysis (e.g., paired with `spillover_timecourse()`)."><meta property="og:description" content="Aggregates expression data using gene-level spillover weights. Accepts either a single matrix/vector
or lists of both for timecourse-style analysis (e.g., paired with `spillover_timecourse()`)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">QUESTIONS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/CarlyBobak/QUESTIONS/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Compute sample-level spillover summary scores</h1>
      <small class="dont-index">Source: <a href="https://github.com/CarlyBobak/QUESTIONS/blob/master/R/questions.R" class="external-link"><code>R/questions.R</code></a></small>
      <div class="d-none name"><code>summarize_spillover_per_sample.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Aggregates expression data using gene-level spillover weights. Accepts either a single matrix/vector
or lists of both for timecourse-style analysis (e.g., paired with `spillover_timecourse()`).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">summarize_spillover_per_sample</span><span class="op">(</span></span>
<span>  <span class="va">expr</span>,</span>
<span>  <span class="va">spillover</span>,</span>
<span>  summary_fn <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  normalize_scores <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  genes_in_rows <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  abs_expression <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-expr">expr<a class="anchor" aria-label="anchor" href="#arg-expr"></a></dt>
<dd><p>Either a matrix/data.frame (genes × samples) or a list of such matrices.</p></dd>


<dt id="arg-spillover">spillover<a class="anchor" aria-label="anchor" href="#arg-spillover"></a></dt>
<dd><p>Either a named numeric vector of spillover scores or a list of such vectors.</p></dd>


<dt id="arg-summary-fn">summary_fn<a class="anchor" aria-label="anchor" href="#arg-summary-fn"></a></dt>
<dd><p>Optional custom function: takes two arguments (expr, spillover) and returns a scalar.
Default is a weighted sum of expr × spillover.</p></dd>


<dt id="arg-normalize-scores">normalize_scores<a class="anchor" aria-label="anchor" href="#arg-normalize-scores"></a></dt>
<dd><p>Logical. Whether to normalize spillover scores (ie return spillover Z scores) (default = FALSE).</p></dd>


<dt id="arg-genes-in-rows">genes_in_rows<a class="anchor" aria-label="anchor" href="#arg-genes-in-rows"></a></dt>
<dd><p>Logical. TRUE if rows are genes and columns are samples (default = FALSE).</p></dd>


<dt id="arg-abs-expression">abs_expression<a class="anchor" aria-label="anchor" href="#arg-abs-expression"></a></dt>
<dd><p>Logical. If TRUE, take absolute value of expression before summarizing (default = FALSE).</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Logical. Whether to print progress and diagnostics (default = TRUE).</p>
<p>#' @details
**Interpreting Per-Sample Spillover Scores**</p>
<p>This function computes a summary score for each sample, reflecting how strongly the sample expresses genes
that were influenced by network-based spillover from upstream signals (e.g., hub genes or initiators).</p>
<p>The default scoring function calculates a weighted sum:</p>
<p>$$
  \text{score}_s = \sum_{g \in G} \text{expression}_{gs} \times \text{spillover}_g
$$</p>
<p>where:
- \(G\) is the set of genes with non-zero spillover
- \(\text{expression}_{gs}\) is the expression of gene *g* in sample *s*
- \(\text{spillover}_g\) is the spillover score assigned to gene *g* at that timepoint</p>
<p>This score can be interpreted as the degree to which a sample expresses the genes that received
signal via network propagation. Higher values suggest a stronger manifestation of upstream network activity.</p>
<p>**Z-score Option (`normalize_samples = TRUE`):**
When this is enabled, the resulting spillover scores are standardized across samples:</p>
<p>$$
  Z_s = \frac{\text{score}_s - \mu}{\sigma}
$$</p>
<p>where \(\mu\) and \(\sigma\) are the mean and standard deviation of spillover scores across all samples.
Z-scores are useful for comparing samples across different datasets or timepoints, or when integrating with other predictors.</p>
<p>**Absolute Expression Option (`abs_expression = TRUE`):**
This flag takes the absolute value of expression values before applying the spillover weights. This helps avoid
signal cancellation if the expression data has been centered, scaled, or otherwise contains negative values.
It is especially useful when the presence or magnitude of expression is of interest, rather than its direction.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A named numeric vector (if single input) or named list of per-timepoint score vectors.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Single timepoint</span></span></span>
<span class="r-in"><span><span class="va">scores</span> <span class="op">&lt;-</span> <span class="fu">summarize_spillover_per_sample</span><span class="op">(</span><span class="va">expr</span>, <span class="va">spillover_vec</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Timecourse</span></span></span>
<span class="r-in"><span><span class="va">scores_list</span> <span class="op">&lt;-</span> <span class="fu">summarize_spillover_per_sample</span><span class="op">(</span><span class="va">expr_list</span>, <span class="va">spillover_list</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Carly Bobak.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

