<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Summarize sample-level spillover per module across a timecourse — summarize_spillover_by_sample_and_module • QUESTIONS</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Summarize sample-level spillover per module across a timecourse — summarize_spillover_by_sample_and_module"><meta name="description" content="This function calculates a spillover summary score for each sample, grouped by gene module,
across a timecourse of expression matrices and spillover vectors. It supports optional
absolute-value transformation of expression and z-score normalization of the final result."><meta property="og:description" content="This function calculates a spillover summary score for each sample, grouped by gene module,
across a timecourse of expression matrices and spillover vectors. It supports optional
absolute-value transformation of expression and z-score normalization of the final result."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">QUESTIONS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/CarlyBobak/QUESTIONS/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Summarize sample-level spillover per module across a timecourse</h1>
      <small class="dont-index">Source: <a href="https://github.com/CarlyBobak/QUESTIONS/blob/master/R/questions.R" class="external-link"><code>R/questions.R</code></a></small>
      <div class="d-none name"><code>summarize_spillover_by_sample_and_module.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function calculates a spillover summary score for each sample, grouped by gene module,
across a timecourse of expression matrices and spillover vectors. It supports optional
absolute-value transformation of expression and z-score normalization of the final result.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">summarize_spillover_by_sample_and_module</span><span class="op">(</span></span>
<span>  <span class="va">expr_list</span>,</span>
<span>  <span class="va">spillover_list</span>,</span>
<span>  <span class="va">module_membership_list</span>,</span>
<span>  summary_func <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  genes_in_rows <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  abs_expression <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  normalize_scores <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-expr-list">expr_list<a class="anchor" aria-label="anchor" href="#arg-expr-list"></a></dt>
<dd><p>A list of gene expression matrices, one per timepoint (samples × genes).
Must be in the same order as `spillover_list`.</p></dd>


<dt id="arg-spillover-list">spillover_list<a class="anchor" aria-label="anchor" href="#arg-spillover-list"></a></dt>
<dd><p>A list of named numeric vectors of spillover scores, one per timepoint.
Names must match gene names in expression and module inputs.</p></dd>


<dt id="arg-module-membership-list">module_membership_list<a class="anchor" aria-label="anchor" href="#arg-module-membership-list"></a></dt>
<dd><p>A list of named vectors mapping genes to modules (character or factor), one per timepoint.</p></dd>


<dt id="arg-summary-func">summary_func<a class="anchor" aria-label="anchor" href="#arg-summary-func"></a></dt>
<dd><p>Optional. A function to compute the summary statistic (default = sum(expr × spillover)).
The function must accept two numeric vectors: expression and spillover.</p></dd>


<dt id="arg-genes-in-rows">genes_in_rows<a class="anchor" aria-label="anchor" href="#arg-genes-in-rows"></a></dt>
<dd><p>Logical. TRUE if rows are genes and columns are samples (default = FALSE).</p></dd>


<dt id="arg-abs-expression">abs_expression<a class="anchor" aria-label="anchor" href="#arg-abs-expression"></a></dt>
<dd><p>Logical. If TRUE, take absolute value of expression before applying `summary_func` (default = FALSE).</p></dd>


<dt id="arg-normalize-scores">normalize_scores<a class="anchor" aria-label="anchor" href="#arg-normalize-scores"></a></dt>
<dd><p>Logical. If TRUE, z-score standardize the spillover scores across samples (per module) (default = FALSE).</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Logical. If TRUE, print progress messages (default = TRUE).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of data frames, one per timepoint. Each data frame is samples × modules, with spillover summary scores.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This enables downstream analyses such as:
- Tracing how module-specific signal propagates through time
- Associating spillover magnitude with phenotypes
- Contrasting signal distribution across modules and samples</p>

<p>**Interpreting Spillover Summary Values**</p>
<p>This function calculates a summary score for each sample that reflects the *weighted influence*
of genes receiving spillover signal, aggregated within each module. The default score is computed as:</p>
<p>$$
  \text{score}_{is} = \sum_{g \in M_i} \text{expression}_{sg} \times \text{spillover}_g
$$</p>
<p>where:
- \(M_i\) is the set of genes in module *i*
- \(\text{expression}_{sg}\) is the expression of gene *g* in sample *s*
- \(\text{spillover}_g\) is the spillover score assigned to gene *g* at that timepoint</p>
<p>The result reflects how strongly a sample expresses genes that were targeted by spillover, and thus may
indicate whether the biological effects of an upstream perturbation are active in that sample.</p>
<p>**Z-score Option (`normalize_scores = TRUE`):**
When enabled, scores are standardized *per module* (i.e., column-wise) across all samples:</p>
<p>$$
  Z_{is} = \frac{\text{score}_{is} - \mu_i}{\sigma_i}
$$</p>
<p>where \(\mu_i\) and \(\sigma_i\) are the mean and standard deviation of scores for module *i* across samples.
Z-scoring is useful when comparing modules with different dynamic ranges, or when integrating scores across timepoints.</p>
<p>**Absolute Expression Option (`abs_expression = TRUE`):**
When this option is set, gene expression values are converted to absolute values before weighting. This can help
avoid cancellation effects if the expression matrix has been centered or includes negative values (e.g., z-scores or residuals).
Use this option when the biological interpretation of expression is directional (e.g., presence/absence) rather than fold-change.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Basic usage with z-score</span></span></span>
<span class="r-in"><span><span class="va">module_scores</span> <span class="op">&lt;-</span> <span class="fu">summarize_spillover_by_sample_and_module</span><span class="op">(</span><span class="va">expr_list</span>, <span class="va">spillover_list</span>, <span class="va">module_list</span>,</span></span>
<span class="r-in"><span>                   normalize_scores <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use absolute expression with custom summary</span></span></span>
<span class="r-in"><span><span class="va">module_scores</span> <span class="op">&lt;-</span> <span class="fu">summarize_spillover_by_sample_and_module</span><span class="op">(</span><span class="va">expr_list</span>, <span class="va">spillover_list</span>, <span class="va">module_list</span>,</span></span>
<span class="r-in"><span>                   abs_expression <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                   summary_func <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">expr</span>, <span class="va">spill</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">expr</span> <span class="op">*</span> <span class="va">spill</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Carly Bobak.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

