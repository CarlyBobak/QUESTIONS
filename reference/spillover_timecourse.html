<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate timecourse spillover across multiple networks — spillover_timecourse • QUESTIONS</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate timecourse spillover across multiple networks — spillover_timecourse"><meta name="description" content="This function iteratively computes gene-level spillover across a series of networks (e.g., WGCNA results or TOM/adjacency matrices),
using a propagation model. Spillover can begin from a shared initiator list or from timepoint-specific gene sets and optionally
incorporate gene-level effects such as fold changes or module membership. Propagation can be binary or continuous, and supports
persistent initiators and feedback from previous spillover states. The function also supports optional pruning of dense networks
using a similarity threshold or top-k strongest connections per row."><meta property="og:description" content="This function iteratively computes gene-level spillover across a series of networks (e.g., WGCNA results or TOM/adjacency matrices),
using a propagation model. Spillover can begin from a shared initiator list or from timepoint-specific gene sets and optionally
incorporate gene-level effects such as fold changes or module membership. Propagation can be binary or continuous, and supports
persistent initiators and feedback from previous spillover states. The function also supports optional pruning of dense networks
using a similarity threshold or top-k strongest connections per row."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">QUESTIONS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/CarlyBobak/QUESTIONS/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Calculate timecourse spillover across multiple networks</h1>
      <small class="dont-index">Source: <a href="https://github.com/CarlyBobak/QUESTIONS/blob/master/R/questions.R" class="external-link"><code>R/questions.R</code></a></small>
      <div class="d-none name"><code>spillover_timecourse.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function iteratively computes gene-level spillover across a series of networks (e.g., WGCNA results or TOM/adjacency matrices),
using a propagation model. Spillover can begin from a shared initiator list or from timepoint-specific gene sets and optionally
incorporate gene-level effects such as fold changes or module membership. Propagation can be binary or continuous, and supports
persistent initiators and feedback from previous spillover states. The function also supports optional pruning of dense networks
using a similarity threshold or top-k strongest connections per row.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">spillover_timecourse</span><span class="op">(</span></span>
<span>  <span class="va">network_list</span>,</span>
<span>  <span class="va">initiator_genes</span>,</span>
<span>  gene_effects <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  row_normalize <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  binary <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  threshold_spillover <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  threshold <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  calc_threshold <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  quantile <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  persistent_initiators <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  use_previous_spillover <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  prune <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  prune_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>auto <span class="op">=</span> <span class="cn">FALSE</span>, target_sparsity <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-network-list">network_list<a class="anchor" aria-label="anchor" href="#arg-network-list"></a></dt>
<dd><p>A named list of networks (matrices or WGCNA result objects), one per timepoint (T2 to Tn).</p></dd>


<dt id="arg-initiator-genes">initiator_genes<a class="anchor" aria-label="anchor" href="#arg-initiator-genes"></a></dt>
<dd><p>Either a character vector of shared initiators or a list of vectors, one per timepoint (T1 to Tn-1).</p></dd>


<dt id="arg-gene-effects">gene_effects<a class="anchor" aria-label="anchor" href="#arg-gene-effects"></a></dt>
<dd><p>Optional: either a named numeric vector of gene effects (e.g., logFCs) or a list of such vectors per timepoint.
If not provided, defaults to 1 for initiators and 0 otherwise.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>Numeric. Damping parameter controlling signal retention (default = 1). Set between 0 (no propagation) and 1 (full propagation).</p></dd>


<dt id="arg-row-normalize">row_normalize<a class="anchor" aria-label="anchor" href="#arg-row-normalize"></a></dt>
<dd><p>Logical. Whether to row-wise normalize the matrix before computing spillover values. (default = TRUE).</p></dd>


<dt id="arg-binary">binary<a class="anchor" aria-label="anchor" href="#arg-binary"></a></dt>
<dd><p>Logical. If TRUE, converts output at each timepoint to binary using a threshold (default = TRUE).</p></dd>


<dt id="arg-threshold-spillover">threshold_spillover<a class="anchor" aria-label="anchor" href="#arg-threshold-spillover"></a></dt>
<dd><p>Logical. If TRUE only spillove values above threshold will be retained (defualt = FALSE).</p></dd>


<dt id="arg-threshold">threshold<a class="anchor" aria-label="anchor" href="#arg-threshold"></a></dt>
<dd><p>Numeric. Used if `binary = TRUE` or `threshold_spillover = TRUE` to define the activation cutoff (default = 0).</p></dd>


<dt id="arg-calc-threshold">calc_threshold<a class="anchor" aria-label="anchor" href="#arg-calc-threshold"></a></dt>
<dd><p>Logical. If TRUE, uses spillover_threshold_from_degree to calculate a topology informed threshold for significant spillover.</p></dd>


<dt id="arg-quantile">quantile<a class="anchor" aria-label="anchor" href="#arg-quantile"></a></dt>
<dd><p>Numeric. Value between 0 and 1 (default = 0.95). The spilllover threshold is set at this quantile of the expected background distribution.</p></dd>


<dt id="arg-persistent-initiators">persistent_initiators<a class="anchor" aria-label="anchor" href="#arg-persistent-initiators"></a></dt>
<dd><p>Logical. If TRUE, initiators accumulate over time and remain active after first activation (default = FALSE).</p></dd>


<dt id="arg-use-previous-spillover">use_previous_spillover<a class="anchor" aria-label="anchor" href="#arg-use-previous-spillover"></a></dt>
<dd><p>Logical. If TRUE, uses spillover output from the previous timepoint as the gene effects at the next timepoint (default = FALSE).</p></dd>


<dt id="arg-prune">prune<a class="anchor" aria-label="anchor" href="#arg-prune"></a></dt>
<dd><p>Logical. Whether to prune the network matrix before computing spillover (default = FALSE).</p></dd>


<dt id="arg-prune-args">prune_args<a class="anchor" aria-label="anchor" href="#arg-prune-args"></a></dt>
<dd><p>A named list of arguments passed to `prune_matrix()`, such as `method`, `value`, `auto`, and `target_sparsity`.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Logical. If TRUE, prints diagnostic and progress messages (default = TRUE).</p>
<p>#' @details
**Overview and Interpretation**</p>
<p>This function generalizes the single-step spillover propagation to an entire *timecourse* of network states,
allowing users to track how influence from an initial set of genes evolves across multiple biological snapshots (e.g., timepoints, conditions).</p>
<p>For each timepoint, spillover is calculated using the following damped propagation model:</p>
<p>$$
  \text{spillover}_{t} = \alpha \cdot W_{t} \cdot \text{effects}_{t} + (1 - \alpha) \cdot \text{effects}_{t}
$$</p>
<p>where:
- \(W_{t}\) is the network matrix at timepoint \(t\), optionally pruned and row-normalized,
- \(\text{effects}_{t}\) is a gene-level effect vector derived from initiators or the previous spillover state,
- \(\alpha\) controls how much signal propagates vs. remains locally conserved.</p>
<p>**Options and Flexibility**</p>
<p>- **Initiator Genes**: The function supports either a single set of initiators or a list for per-timepoint variation.
- **Persistent Initiators**: If enabled, genes that were active in any prior step remain active in subsequent ones.
- **Previous Spillover as Input**: Allows dynamic feedback, where the spillover at \(t-1\) seeds the effects at \(t\).
- **Thresholding**: Optional filtering of weak spillover using either a fixed numeric cutoff or a topology-aware quantile threshold from `spillover_threshold_from_degree()`.
- **Binary Conversion**: If enabled, spillover values are binarized (1/0) to reflect activation status, useful for logic-based modeling or visualization.
- **Pruning**: Supports automatic or manual reduction of network density to enhance signal-to-noise and speed.</p>
<p>**Interpretation Guidance**</p>
<p>- Raw spillover scores reflect the accumulated influence of initiators on each gene at each timepoint.
- These scores can be used to identify genes that consistently accumulate signal, detect pathway shifts, or correlate with phenotypic changes.
- Thresholding or binarization is helpful when inferring discrete activation or tracing modules step-by-step.
- Use `spillover_threshold_from_degree()` for principled cutoffs based on network structure, especially in row-normalized matrices.</p>
<p>This function is particularly well-suited for longitudinal studies (e.g., developmental timecourses, intervention responses),
where spillover-based diffusion reveals shifting patterns of gene influence across the network's evolving topology.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A named list of spillover vectors (named numeric vectors) for each timepoint in the input list.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="calculate_spillover.html">calculate_spillover</a></code>, <code><a href="prune_matrix.html">prune_matrix</a></code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Carly Bobak.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

