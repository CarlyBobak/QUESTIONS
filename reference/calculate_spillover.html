<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate gene-level spillover from time 1 to time 2 — calculate_spillover • QUESTIONS</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate gene-level spillover from time 1 to time 2 — calculate_spillover"><meta name="description" content="This function estimates spillover effects from a set of initiator genes (with optional initial effects)
using a transition matrix derived from a TOM matrix, adjacency matrix, or WGCNA object. Optionally, the
network matrix can be pruned to remove weak or noisy connections using either a threshold or top-k filtering strategy."><meta property="og:description" content="This function estimates spillover effects from a set of initiator genes (with optional initial effects)
using a transition matrix derived from a TOM matrix, adjacency matrix, or WGCNA object. Optionally, the
network matrix can be pruned to remove weak or noisy connections using either a threshold or top-k filtering strategy."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">QUESTIONS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/CarlyBobak/QUESTIONS/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Calculate gene-level spillover from time 1 to time 2</h1>
      <small class="dont-index">Source: <a href="https://github.com/CarlyBobak/QUESTIONS/blob/master/R/questions.R" class="external-link"><code>R/questions.R</code></a></small>
      <div class="d-none name"><code>calculate_spillover.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function estimates spillover effects from a set of initiator genes (with optional initial effects)
using a transition matrix derived from a TOM matrix, adjacency matrix, or WGCNA object. Optionally, the
network matrix can be pruned to remove weak or noisy connections using either a threshold or top-k filtering strategy.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">calculate_spillover</span><span class="op">(</span></span>
<span>  <span class="va">network</span>,</span>
<span>  <span class="va">initiator_genes</span>,</span>
<span>  gene_effects <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  row_normalize <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  prune <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  prune_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>value <span class="op">=</span> <span class="cn">NULL</span>, auto <span class="op">=</span> <span class="cn">TRUE</span>, target_sparsity <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-network">network<a class="anchor" aria-label="anchor" href="#arg-network"></a></dt>
<dd><p>An adjacency matrix, TOM matrix, or a WGCNA result object (list with `TOM`, `adjacency`, or `datExpr`).</p></dd>


<dt id="arg-initiator-genes">initiator_genes<a class="anchor" aria-label="anchor" href="#arg-initiator-genes"></a></dt>
<dd><p>A vector of gene names to initialize spillover from. Can represent hub genes, biomarkers, etc.</p></dd>


<dt id="arg-gene-effects">gene_effects<a class="anchor" aria-label="anchor" href="#arg-gene-effects"></a></dt>
<dd><p>Optional named numeric vector with effect sizes (e.g., logFC or median shift) for initiators. Default = 1.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>Damping parameter controlling conservation of original signal (default = 1). Set between 0 (no propagation) and 1 (full propagation).</p></dd>


<dt id="arg-row-normalize">row_normalize<a class="anchor" aria-label="anchor" href="#arg-row-normalize"></a></dt>
<dd><p>Logical. Whether to row-wise normalize the matrix before computing spillover values. (default = TRUE).</p></dd>


<dt id="arg-prune">prune<a class="anchor" aria-label="anchor" href="#arg-prune"></a></dt>
<dd><p>Logical. Whether to prune the network matrix before computing spillover (default = FALSE).</p></dd>


<dt id="arg-prune-args">prune_args<a class="anchor" aria-label="anchor" href="#arg-prune-args"></a></dt>
<dd><p>A named list of arguments passed to `prune_matrix()`, such as `value`, `auto`, and `target_sparsity`.</p>
<p>#' @details
**Spillover Calculation and Interpretation**</p>
<p>This function estimates gene-level *spillover*, representing the indirect influence of upstream initiator genes
as propagated through a gene similarity network (e.g., adjacency or TOM matrix). The propagation follows
a dampened diffusion model:</p>
<p>$$
  \text{spillover} = \alpha \cdot W \cdot \text{initial\_effects} + (1 - \alpha) \cdot \text{initial\_effects}
$$</p>
<p>where:
- \(W\) is the (optionally normalized) similarity or transition matrix,
- \(\text{initial\_effects}\) is a vector of user-specified gene-level initiator values (default = 1),
- \(\alpha\) is a damping parameter that controls how much signal is allowed to propagate versus being retained.</p>
<p>The output is a named numeric vector of spillover scores for each gene, reflecting the degree to which
each gene was influenced by the initiators, either directly (if it is an initiator itself) or indirectly
through connected neighbors in the network.</p>
<p>- Higher spillover values indicate greater expected influence from initiator genes.
- When `row_normalize = TRUE`, each row of the matrix \(W\) is scaled to sum to 1, making the spillover
  interpretable as a probabilistic distribution of influence across neighbors.
- When `alpha = 1`, only indirect signal is retained; lower alpha retains more direct signal.</p>
<p>**Interpretation Notes:**
- If pruning is enabled, weak connections are removed before computing spillover. This can sharpen signal
  and improve interpretability but may reduce sensitivity to diffuse propagation.
- Raw spillover values are continuous, but follow-up steps can apply thresholds or binarization to select
  genes with biologically meaningful levels of inferred influence.</p>
<p>This function serves as the core engine for timecourse analyses (see `spillover_timecourse()`) and
downstream integration with expression and phenotype data.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A named numeric vector of spillover scores at time 2 for all genes in the network.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="prune_matrix.html">prune_matrix</a></code> for preprocessing options to filter weak edges before spillover.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">spillover</span> <span class="op">&lt;-</span> <span class="fu">calculate_spillover</span><span class="op">(</span></span></span>
<span class="r-in"><span>  network <span class="op">=</span> <span class="va">tom_matrix</span>,</span></span>
<span class="r-in"><span>  initiator_genes <span class="op">=</span> <span class="va">hub_genes</span>,</span></span>
<span class="r-in"><span>  alpha <span class="op">=</span> <span class="fl">0.85</span>,</span></span>
<span class="r-in"><span>  prune <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  prune_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"threshold"</span>, auto <span class="op">=</span> <span class="cn">TRUE</span>, target_sparsity <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Carly Bobak.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

